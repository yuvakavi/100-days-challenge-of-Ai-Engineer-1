%pip install numpy pandas matplotlib tensorflow
# ğŸ“¦ Import Libraries
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import GRU, Dense
from sklearn.preprocessing import MinMaxScaler

# ğŸŒ¡ï¸ Step 1: Create Dummy Temperature Data (for 100 days)
np.random.seed(0)
days = np.arange(1, 101)
temperature = 25 + np.sin(days / 5) * 5 + np.random.normal(0, 0.5, 100)
data = pd.DataFrame({'Day': days, 'Temperature': temperature})

# ğŸŒ¡ï¸ Step 2: Normalize Data (0-1 range)
scaler = MinMaxScaler(feature_range=(0, 1))
scaled_temp = scaler.fit_transform(data['Temperature'].values.reshape(-1, 1))

# ğŸŒ¡ï¸ Step 3: Prepare Training Data (7 days â†’ 1 next day)
X, y = [], []
for i in range(7, len(scaled_temp)):
    X.append(scaled_temp[i-7:i, 0])  # previous 7 days
    y.append(scaled_temp[i, 0])      # next day

X, y = np.array(X), np.array(y)
X = X.reshape((X.shape[0], X.shape[1], 1))  # [samples, timesteps, features]

# ğŸŒ¡ï¸ Step 4: Build GRU Model
model = Sequential([
    GRU(32, input_shape=(7, 1), activation='tanh'),
    Dense(1)
])
model.compile(optimizer='adam', loss='mse')

# ğŸŒ¡ï¸ Step 5: Train Model
model.fit(X, y, epochs=100, batch_size=8, verbose=0)

# ğŸŒ¡ï¸ Step 6: Predict Next Day Temperature
last_7_days = scaled_temp[-7:].reshape(1, 7, 1)
predicted_scaled = model.predict(last_7_days)
predicted_temp = scaler.inverse_transform(predicted_scaled)

print(f"ğŸŒ¦ï¸ Predicted Temperature for next day: {predicted_temp[0][0]:.2f}Â°C")

# ğŸŒ¡ï¸ Step 7: Plot Results
plt.figure(figsize=(8,4))
plt.plot(data['Day'], data['Temperature'], label='Actual Temp')
plt.scatter(101, predicted_temp, color='red', label='Predicted Next Day')
plt.xlabel("Day")
plt.ylabel("Temperature (Â°C)")
plt.legend()
plt.title("Weather Prediction using GRU")
plt.show()
