from sklearn import datasets
from sklearn.semi_supervised import LabelSpreading
from sklearn.metrics import accuracy_score
import numpy as np
# Load digit dataset (0â€“9)
digits = datasets.load_digits()
X = digits.data
y = digits.target
# Copy labels
labels = np.copy(y)

# Randomly remove labels (keep only 10%)
rng = np.random.RandomState(42)
random_unlabeled_points = rng.rand(len(y)) < 0.9
labels[random_unlabeled_points] = -1  # -1 means unlabeled
model = LabelSpreading(kernel='knn', n_neighbors=7)
model.fit(X, labels)
predicted_labels = model.transduction_
accuracy = accuracy_score(y, predicted_labels)
print(f"Semi-supervised accuracy: {accuracy:.2f}")
print("Number of unlabeled samples labeled by model:", sum(labels == -1))
