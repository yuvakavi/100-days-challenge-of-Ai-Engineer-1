import numpy as np
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import Adam

# 1️⃣ Create simple data
X = np.linspace(-10, 10, 1000).reshape(-1, 1)
y = (X > 0).astype(int)  # 1 if number > 0, else 0

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

# 2️⃣ Try different activation functions
activations = ['sigmoid', 'tanh', 'relu']
results = {}

for act in activations:
    model = Sequential([
        Dense(8, input_dim=1, activation=act),
        Dense(4, activation=act),
        Dense(1, activation='sigmoid')
    ])
    model.compile(optimizer=Adam(0.01), loss='binary_crossentropy', metrics=['accuracy'])
    model.fit(X_train, y_train, epochs=30, verbose=0)
    acc = model.evaluate(X_test, y_test, verbose=0)[1]
    results[act] = acc

# 3️⃣ Show comparison
plt.bar(results.keys(), results.values(), color=['skyblue', 'orange', 'lightgreen'])
plt.title('Accuracy with Different Activation Functions')
plt.ylabel('Accuracy')
plt.show()
